import{a as f}from"./chunk-KQYNL3Z4.js";import{N as r,R as c,_b as n,h as s,pa as a}from"./chunk-5TTR76IQ.js";var p=class o{constructor(e,t){this.platformId=e;this.authService=t;this.loadProjects()}projectsSubject=new s([]);projects$=this.projectsSubject.asObservable();loadProjects(){let e=this.authService.currentUserValue,t="projects_guest";if(n(this.platformId))if(e){t="projects_"+e.email;let i=JSON.parse(localStorage.getItem(t)||"[]");i.length===0&&(i=JSON.parse(localStorage.getItem("projects")||"[]"),i.length>0&&(localStorage.setItem(t,JSON.stringify(i)),localStorage.removeItem("projects"))),this.projectsSubject.next(i)}else{let i=JSON.parse(localStorage.getItem(t)||"[]");this.projectsSubject.next(i)}}saveProjects(e){let t=this.authService.currentUserValue,i=t?"projects_"+t.email:"projects_guest";n(this.platformId)&&localStorage.setItem(i,JSON.stringify(e)),this.projectsSubject.next(e)}updateProject(e){let t=this.projectsSubject.value,i=t.findIndex(j=>j.id===e.id);i!==-1&&(t[i]=e,this.saveProjects(t))}deleteProject(e){let t=this.projectsSubject.value.filter(i=>i.id!==e);this.saveProjects(t)}getTasks(){return this.projectsSubject.value.flatMap(e=>e.tasks||[])}getProjects(){return this.projectsSubject.value}static \u0275fac=function(t){return new(t||o)(c(a),c(f))};static \u0275prov=r({token:o,factory:o.\u0275fac,providedIn:"root"})},u=class o{notifications=[];notificationsSubject=new s([]);notifications$=this.notificationsSubject.asObservable();addNotification(e,t){let i={id:Date.now(),message:e,time:t};this.notifications.unshift(i),this.notifications.length>10&&this.notifications.pop(),this.notificationsSubject.next([...this.notifications])}removeNotification(e){this.notifications=this.notifications.filter(t=>t.id!==e),this.notificationsSubject.next([...this.notifications])}static \u0275fac=function(t){return new(t||o)};static \u0275prov=r({token:o,factory:o.\u0275fac,providedIn:"root"})};export{p as a};
